{% if service.options.zsh|default(false) and service.options.custom_zsh|default(false) %}
# --- Antigen

source ~/.antigen.zsh

antigen use oh-my-zsh

antigen bundle git
antigen bundle common-aliases
antigen bundle git-extras
antigen bundle git-flow
antigen bundle web-search
antigen bundle docker
antigen bundle docker-compose
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-history-substring-search ./zsh-history-substring-search.zsh
antigen bundle command-not-found

{% if service.options.powerline|default(false) %}
POWERLEVEL9K_INSTALLATION_PATH=$ANTIGEN_BUNDLES/bhilburn/powerlevel9k
antigen theme bhilburn/powerlevel9k powerlevel9k
{% else %}
antigen theme nebirhos
{% endif %}

antigen apply
{% endif %}

{% if service.dockerContainer.isPackageManager(
        constant('Ph3\\DockerArch\\Domain\\DockerContainer\\Model\\DockerContainerInterface::PACKAGE_MANAGER_TYPE_APK')
    ) %}
### --- Alpine tricks.

unalias grep 2>/dev/null
{% endif %}

### --- Envs.

export EDITOR="vim"
export GIT_EDITOR="vim"
{% if service.options.zsh|default(false) and service.options.custom_zsh|default(false)
    and service.options.powerline|default(false) %}
POWERLEVEL9K_CUSTOM_DOCKER_CONTAINER="echo 'üê≥  {{ service.identifier }} @ {{ service.project.identifier }}'"
POWERLEVEL9K_CUSTOM_DOCKER_CONTAINER_BACKGROUND=""
POWERLEVEL9K_CUSTOM_DOCKER_CONTAINER_FOREGROUND="black"
POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(custom_docker_container context dir rbenv vcs)
{% else %}
if [ -z "$PS1" ]; then
    export PS1="üê≥  {{ service.identifier }} @ {{ service.project.identifier }} ... "$PS1
else
    export PROMPT="üê≥  {{ service.identifier }} @ {{ service.project.identifier }} ... "$PROMPT
fi
{% endif %}

### --- SSH

eval `ssh-agent -s` 2>/dev/null
if [ -d ~/.ssh ]; then
    ssh-add $(find ~/.ssh -maxdepth 1 -type f -printf '%p\n' | grep id_) &> /dev/null
fi

### --- Aliases

{% if service.isWebService %}
alias cho="chown -R www-data:www-data . && echo '> CHOWN applied for www-data'"
{% if service.options.composer|default(false) == true %}
alias composer="php -d memory_limit=-1 /bin/composer"
alias fcomposer="php -d memory_limit=-1 -n /bin/composer"
{% endif %}
{% if service.options.app_type|default(null) == 'symfony' %}
alias sf="if [ -f \"$PWD/var/bootstrap.php.cache\" ]; then ./bin/console $*; else ./app/console $*; fi"
alias sfcc="if [ -f \"$PWD/var/bootstrap.php.cache\" ]; then /bin/rm -rf var/cache/*; else /bin/rm -rf app/cache/*; fi && echo '> Cache cleared'"
alias sfca="/bin/rm -rf web/bundles/* && sf assets:install --symlink"
alias sfa="sfca && sf assetic:dump --env=prod --no-debug"
{% endif %}
{% endif %}

echo "  |"
echo "  | Welcome to {{ service.identifier }} container!"
echo "  | This container has been generated by {{ constant('\\Ph3\\DockerArch\\Application\\Architect::PROJECT_NAME') }} open source project."
echo "  |"
echo "  | Enjoy! üê≥"
echo "  |"
